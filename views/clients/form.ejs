<%- include('../partials/clients/header') %>

<style>
  .shadow-soft {
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    border-radius: 20px;
    background-color: white;
  }

  .custom-btn {
    background: linear-gradient(90deg, #9f7fff 0%, #8055fe 100%);
    color: white;
    padding: 0.75rem 2.5rem;
    border: none;
    border-radius: 100px;
    font-weight: 600;
    font-size: 1rem;
    box-shadow: 0 10px 25px rgba(128, 85, 254, 0.4);
    transition: all 0.3s ease;
  }

  .custom-btn:hover {
    box-shadow: 0 12px 30px rgba(128, 85, 254, 0.6);
    transform: translateY(-2px);
  }

  .avatar-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    cursor: pointer;
  }

  .avatar-card:hover {
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
  }

  .avatar-card.selected {
    border: 3px solid #f9d857;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.25);
  }

  .gender-btn.active {
    background-color: #ffc107;
    color: #000;
    border: none;
  }

  .section-title {
    font-weight: 600;
    font-size: 18px;
  }

  .section-label {
    text-align: center;
    background-color: #ffde74;
    border-radius: 20px;
    padding: 8px 16px;
    font-size: 16px;
    font-weight: 500; /* Medium weight */
    font-family: "Lexend", sans-serif;
    margin-bottom: 15px;
    font-weight: 500;
    color: #222;
  }

  .avatars {
    display: flex;
    gap: 50px;
    justify-content: center;
    margin-bottom: 20px;
  }

  .avatar-card {
    background-color: white;
    border-radius: 20px;
    padding: 10px;
    width: 100%;
    max-width: 148px;
    height: auto;
    aspect-ratio: 148 / 262;
    text-align: center;
    cursor: pointer;
    transition: transform 0.2s;
    box-shadow: 0 16px 32px rgba(0, 0, 0, 0.1);
  }

  .avatar-card:hover {
    transform: translateY(-5px);
  }

  .avatar-card {
    position: relative;
    overflow: visible; /* default-nya biasanya hidden */
    z-index: 1;
  }

  .avatar-img {
    width: 130%; /* lebih besar dari card */
    height: auto;
    object-fit: cover;
    position: absolute;
    transform: translateX(-50%);
    z-index: 2;
  }

  .gender-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-bottom: 25px;
  }

  .gender-btn {
    border: none;
    border-radius: 20px;
    padding: 10px 16px;
    font-weight: bold;
    font-size: 14px;
    flex: 1;
    cursor: pointer;
    background-color: white;
    color: #222;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }

  .gender-btn.active {
    background-color: #ffffff;
    border: 2px solid #4f46e5;
    color: #4f46e5;
  }

  input[type="radio"] {
    display: none;
  }

  .avatar-card img.grayscale {
    filter: grayscale(100%);
    transition: filter 0.3s ease;
  }

  .avatar-card input[type="radio"]:checked + img {
    filter: none !important;
  }
</style>

<main class="d-flex justify-content-center align-items-center mt-5">
  <div class="px-4 text-center" style="max-width: 400px; width: 100%">
    <p class="mb-4" style="font-family: 'Lexend', sans-serif; font-size: 25px; color: #000000; font-weight: bold">
      ISI DATA DIRI SEBELUM <br />
      MEMULAI PERMAINAN.
    </p>

    <form action="/tutor" method="POST">
      <div id="dataDiriSection">
        <div class="form-floating mb-3 shadow-soft">
          <input type="text" class="form-control rounded-4" name="name" placeholder="Nama Karakter" required />
          <label>Nama Karakter</label>
        </div>
        <div class="form-floating mb-3 shadow-soft">
          <input type="text" class="form-control rounded-4" name="namalengkap" placeholder="Nama lengkap" required />
          <label>Nama Lengkap</label>
        </div>
        <div class="form-floating mb-3 shadow-soft">
          <input type="number" class="form-control rounded-4" name="notlp" placeholder="Nomor HP" required />
          <label>Nomor HP</label>
        </div>
        <div class="form-floating mb-4 shadow-soft">
          <input type="text" class="form-control rounded-4" name="ig" placeholder="Instagram" required />
          <label>Instagram</label>
        </div>
        <div class="text-center mt-4">
          <button type="button" id="nextStep" class="custom-btn">Lanjut</button>
        </div>
      </div>

      <div id="genderAvatarSection" style="display: none">
        <div class="section-label">Pilih Karakter</div>
        <!-- GENDER SELECTION -->
        <div class="avatars" id="avatarContainer">
          <!-- Avatar Male (Default) -->
          <label class="avatar-card">
            <input type="radio" name="avatar" value="male1.png" checked />
            <img src="/assets/img/avatar/male1.png" class="avatar-img" alt="Male Avatar 1" />
          </label>
          <label class="avatar-card">
            <input type="radio" name="avatar" value="male2.png" />
            <img src="/assets/img/avatar/male2.png" class="avatar-img" alt="Male Avatar 2" />
          </label>
        </div>

        <!-- Section: Pilih Gender -->
        <div class="section-label">Pilih Jenis Kelamin</div>

        <div class="gender-buttons">
          <button type="button" class="gender-btn active" id="btnMale">♂️ Laki-Laki</button>
          <button type="button" class="gender-btn" id="btnFemale">♀️ Perempuan</button>
        </div>

        <!-- SUBMIT BUTTON -->
        <div class="text-center mt-4">
          <button type="submit" class="custom-btn">Daftar</button>
        </div>
      </div>
    </form>
  </div>
</main>

<%- include('../partials/clients/footer') %>

<script>
  document.getElementById("nextStep").addEventListener("click", function () {
    document.getElementById("dataDiriSection").style.display = "none";
    document.getElementById("genderAvatarSection").style.display = "block";
  });

  const btnMale = document.getElementById("btnMale");
  const btnFemale = document.getElementById("btnFemale");
  const avatarContainer = document.getElementById("avatarContainer");

  const maleAvatars = [
    { src: "/assets/img/avatar/male1.png", value: "male1.png" },
    { src: "/assets/img/avatar/male2.png", value: "male2.png" },
  ];

  const femaleAvatars = [
    { src: "/assets/img/avatar/female1.png", value: "female1.png" },
    { src: "/assets/img/avatar/female2.png", value: "female2.png" },
  ];

  function renderAvatars(avatars) {
    avatarContainer.innerHTML = "";
    avatars.forEach((avatar, index) => {
      const label = document.createElement("label");
      label.classList.add("avatar-card");
      label.innerHTML = `
      <input type="radio" name="avatar" value="${avatar.value}" ${index === 0 ? "checked" : ""}/>
      <img src="${avatar.src}" class="avatar-img grayscale" alt="Avatar ${index + 1}">
    `;
      avatarContainer.appendChild(label);
    });

    setRadioEventListener(); // Tambahkan ini agar avatar update grayscale saat dipilih
  }

  function setRadioEventListener() {
    const allAvatars = avatarContainer.querySelectorAll(".avatar-card");
    allAvatars.forEach((label) => {
      const radio = label.querySelector('input[type="radio"]');
      const img = label.querySelector("img");

      radio.addEventListener("change", () => {
        allAvatars.forEach((otherLabel) => {
          const otherImg = otherLabel.querySelector("img");
          otherImg.classList.add("grayscale");
        });
        img.classList.remove("grayscale");
      });

      // Inisialisasi awal: hanya satu yang aktif
      if (radio.checked) {
        img.classList.remove("grayscale");
      }
    });
  }

  btnMale.addEventListener("click", () => {
    btnMale.classList.add("active");
    btnFemale.classList.remove("active");
    renderAvatars(maleAvatars);
  });

  btnFemale.addEventListener("click", () => {
    btnFemale.classList.add("active");
    btnMale.classList.remove("active");
    renderAvatars(femaleAvatars);
  });

  // Initialize with male avatars
  renderAvatars(maleAvatars);
</script>
