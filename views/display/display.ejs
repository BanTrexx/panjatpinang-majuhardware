<%- include('../partials/clients/header') %>

<style>
  body {
    background-color: #87ceeb;
    margin: 0;
    overflow: hidden;
  }
  .pinang {
    width: 100%;
    height: 100vh;
    position: relative;
  }
  .player {
    position: absolute;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: gold;
    text-align: center;
    line-height: 50px;
    color: #333;
  }
</style>

<div class="pinang" id="pinang"></div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io("ws://192.168.88.158:3000", {
    query: { userId: "display", role: "display" },
  });

  const pinang = document.getElementById("pinang");
  const playersDOM = {};

  socket.on("playersProgress", (players) => {
    console.log(players);
    for (const id in players) {
      if (!playersDOM[id]) {
        const el = document.createElement("div");
        el.className = "player";
        el.textContent = id;
        pinang.appendChild(el);
        playersDOM[id] = el;
      }
      const progress = players[id];
      const maxHeight = window.innerHeight - 50;
      playersDOM[id].style.bottom = `${progress * maxHeight}px`;
      playersDOM[id].style.left = `${
        Object.keys(players).indexOf(id) * 100 + 50
      }px`;
    }
  });
</script>

<%- include('../partials/clients/footer') %>
